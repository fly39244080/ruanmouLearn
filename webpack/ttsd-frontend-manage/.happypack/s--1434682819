'use strict';

require('webStyle/wechat/wechat_entry_point.scss');
var ValidatorObj = require('publicJs/validator');
var commonFun = require('publicJs/commonFun');
var weChatEntryPointForm = globalFun.$('#weChatEntryPointForm');

//用户注册表单校验
var validator = new ValidatorObj.ValidatorForm();
var $errorBox = $('.error-box', $(weChatEntryPointForm));

validator.add(weChatEntryPointForm.mobile, [{
    strategy: 'isNonEmpty',
    errorMsg: '手机号不能为空'
}, {
    strategy: 'isMobile',
    errorMsg: '手机号格式不正确'
}]);

globalFun.addEventHandler(weChatEntryPointForm.mobile, "keyup", "blur", function () {
    var errorMsg = validator.start(this);
    $errorBox.text(errorMsg ? errorMsg : '');
});

weChatEntryPointForm.onsubmit = function (event) {
    $errorBox.text('');
    var errorMsg = validator.start(weChatEntryPointForm.mobile);
    if (errorMsg) {
        $errorBox.text(errorMsg);
        event.preventDefault();
    }
};